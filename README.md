# MadSoft-test

## Тестовое задание для компании MadSoft

Разработайте веб-приложение на Python, используя FastAPI, которое предоставляет API для работы с коллекцией мемов. Приложение должно состоять из двух сервисов: сервис с публичным API с бизнес-логикой и сервис для работы с медиа-файлами, используя S3-совместимое хранилище (н-р, MinIO).     

## Функциональность:

* GET /memes: Получить список всех мемов (с пагинацией).

* GET /memes/{id}: Получить конкретный мем по его ID.

* POST /memes: Добавить новый мем (с картинкой и текстом).

* PUT /memes/{id}: Обновить существующий мем.                                        

* DELETE /memes/{id}: Удалить мем. 

## Требования:                          

* Используйте реляционную СУБД для хранения данных.

* Обеспечьте обработку ошибок и валидацию входных данных.

* Используйте Swagger/OpenAPI для документирования API.

* Напишите хотя бы несколько unit-тестов для проверки основной функциональности.
      
* Напишите Readme, из которого понятна функциональность проекта и инструкция по локальному запуску для разработки.

* Проект должен состоять минимум из: 1 сервис с публичным API, 1 сервис с приватным API для изображений, 1 сервис СУБД, 1 сервис S3-storage.

* Напишите docker-compose.yml для запуска проекта.
---

## Описание проекта

Проект состоит из двух частей.
1. Публичный сервер. В нем реализована основная функциональность по добавлению, обновлению, чтению и удалению контента. В качестве хранилища информации используется PostgreSQL.
2. Приватный сервер. Связан с S3 сервисом MINIO для хранения изображений. Авторизация производится по токену.

### Запуск проекта

Переименовать `env_template` в `.env`. Если будут изменены параметры в `.env` убедитесь, что соответствующие параметры измененены в `docker-compose.yml`.

    docker compose up

### Описание эндпоинтов.

* GET /memes?page=1 - получение списка мемов. Возвращает ответ в формате json

    ```
    {
        "memes": []
    }
    ```

* GET /memes/{id} - Получить конкретный мем по его ID. Ответ возвращается в формате HTML
    ```
    <head>
        <style>
        .image{{
            width:300px;
            height:300px;
            margin:auto;
            text-align:center;
            }}
            img{{
            width:100%;
            }}
        </style>
    </head>
    <body>
        <div class="image">
            <img src="data:{content_type};base64,{response_body}">
            <h1>{result.name}</h1>
        </div>
    </body>
    </html>

    ```

* POST /memes/?name=name -F image= - Добавление нового мема. В ответ возвращает JSON с ссылкой на мем.
    ```
    {
  "status": "added",
  "link": "http://localhost:8000/memes/74"
    }
    ```


* PUT /memes/1/new_name=name -F new_image = - Обновить существующий мем. В ответ возвращает JSON с ссылкой на мем.                                      
    ```
    {
  "status": "updated",
  "link": "http://localhost:8000/memes/74"
    }
    ```
* DELETE /memes/1 - Удалить мем. 


### Тестирование

Тесты запускаются при старте сервиса. Тестируется основная логика. Функции для обращения публичного сервиса к базе данных и к приватному сервису заменены моками.


### Что можно улучшить

1. Добавить тесты для приватного сервиса.
2. Изменить принцип авторизации, так как на данный момент проверятеся правильность токена из конфига.
3. Добавить валидацию картинок.
